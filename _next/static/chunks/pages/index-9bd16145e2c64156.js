(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7008)}])},7361:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var o=n(5893),i=n(9008),a=n.n(i);function r(t){let{children:e}=t;return(0,o.jsx)(a(),{children:(0,o.jsx)("title",{children:e?"".concat(e," | Ketexon"):"Ketexon"})})}n(7294)},7008:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return B}});var o=n(5893),i=n(7294),a=n(7361),r=n(7357),s=n(2734);function c(t,e,n){let o=t.createShader(e);t.shaderSource(o,n),t.compileShader(o);let i=t.getShaderParameter(o,t.COMPILE_STATUS);if(!i){let e="Could not compile shader: ".concat(t.getShaderInfoLog(o));throw t.deleteShader(o),e}return o}var l=n(1849),h=n(3855),u=n(8199),d=n(3176),m=n(4034);class f{}f.TRANSPARENT=l.Z.ZERO,f.BLACK=new l.Z(0,0,0,1),f.RED=new l.Z(1,0,0,1),f.YELLOW=new l.Z(1,1,0,1),f.GREEN=new l.Z(0,1,0,1),f.CYAN=new l.Z(0,1,1,1),f.BLUE=new l.Z(0,0,1,1),f.MAGENTA=new l.Z(1,0,1,1),f.WHITE=new l.Z(1,1,1,1);class g{transformPoint(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.subtract(this.origin).scale(this.scale).transformByQuaternion(this.rotation).add(e?h.Z.ZERO:this.origin).add(this.translation),t}constructor(t){if(this.origin=h.Z.ZERO,this.scale=new h.Z(1,1,1),this.rotation=new u.Z().identity(),this.translation=h.Z.ZERO,t){let{origin:e,scale:n,rotation:o,translation:i}=t;this.origin=e||this.origin,this.scale=n||this.scale,this.rotation=o||this.rotation,this.translation=i||this.translation}}}function v(t){let{bottomLeft:e,topLeft:n,bottomRight:o,topRight:i,flipFace:a,color:r}=t,s=t.material||0,c=new l.Z(...new h.Z().subVectors(o,e).cross(new h.Z().subVectors(n,e)).multiplyByScalar(a?-1:1),1);return!0!==a?[...n,1,...r,...c,s,...e,1,...r,...c,s,...o,1,...r,...c,s,...n,1,...r,...c,s,...o,1,...r,...c,s,...i,1,...r,...c,s]:[...e,1,...r,...c,s,...n,1,...r,...c,s,...o,1,...r,...c,s,...o,1,...r,...c,s,...n,1,...r,...c,s,...i,1,...r,...c,s]}g.IDENTITY=new g;class w{constructor(t){if(this.color=f.WHITE,this.transform=g.IDENTITY,this.material=0,t){let{color:e,transform:n,material:o}=t;this.color=e||this.color,this.transform=n||this.transform,this.material=o||this.material}}}class p extends w{generateVertices(){let t=t=>this.transform.transformPoint(t,!0);return[...v({bottomLeft:t(new h.Z(0,0,0)),topLeft:t(new h.Z(0,0,1)),bottomRight:t(new h.Z(1,0,0)),topRight:t(new h.Z(1,0,1)),color:this.color,flipFace:!0,material:this.material})]}}class b extends w{generateVertices(){let t=t=>this.transform.transformPoint(t,!0);return[...v({bottomLeft:t(new h.Z(0,0,0)),topLeft:t(new h.Z(0,1,0)),bottomRight:t(new h.Z(1,0,0)),topRight:t(new h.Z(1,1,0)),color:this.color,material:this.material,flipFace:!0}),...v({bottomLeft:t(new h.Z(0,0,0)),topLeft:t(new h.Z(0,0,1)),bottomRight:t(new h.Z(1,0,0)),topRight:t(new h.Z(1,0,1)),color:this.color,material:this.material,flipFace:!1}),...v({bottomLeft:t(new h.Z(0,0,0)),topLeft:t(new h.Z(0,0,1)),bottomRight:t(new h.Z(0,1,0)),topRight:t(new h.Z(0,1,1)),color:this.color,material:this.material,flipFace:!0}),...v({bottomLeft:t(new h.Z(0,0,1)),topLeft:t(new h.Z(0,1,1)),bottomRight:t(new h.Z(1,0,1)),topRight:t(new h.Z(1,1,1)),color:this.color,material:this.material,flipFace:!1}),...v({bottomLeft:t(new h.Z(0,1,0)),topLeft:t(new h.Z(0,1,1)),bottomRight:t(new h.Z(1,1,0)),topRight:t(new h.Z(1,1,1)),color:this.color,material:this.material,flipFace:!0}),...v({bottomLeft:t(new h.Z(1,0,0)),topLeft:t(new h.Z(1,0,1)),bottomRight:t(new h.Z(1,1,0)),topRight:t(new h.Z(1,1,1)),color:this.color,material:this.material,flipFace:!1})]}}class x{get bufferSize(){return 4*this.vertices.length}get points(){return this.bufferSize/52}regenerateObject(t){let e=this.objects[t].primitive.generateVertices();this.objects[t].subarray.set(e)}constructor({objects:t}){this.objects={};let e=Object.entries(t).map(t=>{let[e,n]=t;return[e,n instanceof Array?n.map(t=>t.generateVertices()):n.generateVertices()]}),n=e.reduce((t,e)=>{let[n,o]=e;return t+o.length},0);this.vertices=new Float32Array(n);let o=0;for(let[n,i]of e)this.vertices.set(i,o),this.objects[n]={primitive:t[n],subarray:this.vertices.subarray(o,o+i.length)},o+=i.length}}function Z(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return t.replace(/^#([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,(t,e,n,o,i)=>"#".concat(e).concat(e).concat(n).concat(n).concat(o).concat(o)+i?"".concat(i).concat(i):0).substring(1).padEnd(8,"f").match(/.{2}/g).map(t=>parseInt(t,16)*(e?1/255:1))}class y{activate(){}deactivate(){}connect(t){}constructor(t){this.ctx=t}}class A extends y{get master(){return this.gainNode}activate(){this.gainNode.gain.setTargetAtTime(this.gainSettings.gain,this.ctx.currentTime,this.gainSettings.gainAttackSpeed)}deactivate(){this.gainNode.gain.setTargetAtTime(0,this.ctx.currentTime,this.gainSettings.gainDecaySpeed)}connect(t){this.master.connect(t)}constructor(t,e){super(t),this.modulatorGainNode=new GainNode(this.ctx,{gain:0}),this.gainNode=new GainNode(this.ctx,{gain:0}),this.modulatorGainNode.connect(this.gainNode),this.gainSettings={gainAttackSpeed:(null==e?void 0:e.gainAttackSpeed)||.5,gainDecaySpeed:(null==e?void 0:e.gainDecaySpeed)||.3,gain:(null==e?void 0:e.gain)||.5}}}class S extends A{constructor(t,e){super(t,null==e?void 0:e.synthGainCubeSettings);let{type:n,frequency:o,note:i}=e||{};this.oscillator=new OscillatorNode(t,{type:n||"sine",frequency:i?440*Math.pow(2,(function(t){let e=t.match(/^([a-gA-G])(#|b)?(\d+)$/);if(e){let[t,n,o,i]=e,a=(n.toLowerCase().charCodeAt(0)-97)*2;a>=10&&--a,a>=4&&--a,"b"===o&&--a,"#"===o&&++a;let r=parseInt(i);return a>2&&--r,12*r+a+1}return -1}(i)-49)/12):o}),this.oscillator.start(),this.oscillator.connect(super.master)}}class _ extends y{get master(){return this.gain}activate(){this.modulatorGain.gain.setTargetAtTime(this.lfoSettings.amplitude,this.ctx.currentTime,this.lfoSettings.modulatorGainAttack)}deactivate(){this.modulatorGain.gain.setTargetAtTime(0,this.ctx.currentTime,this.lfoSettings.modulatorGainDecay)}connect(t){this.gain.connect(t)}constructor(t,e){super(t),this.lfoSettings={type:(null==e?void 0:e.type)||"sine",frequency:(null==e?void 0:e.frequency)===void 0?1:null==e?void 0:e.frequency,center:(null==e?void 0:e.center)===void 0?1:null==e?void 0:e.center,amplitude:(null==e?void 0:e.amplitude)===void 0?.5:null==e?void 0:e.amplitude,modulatorGainAttack:(null==e?void 0:e.modulatorGainAttack)||.5,modulatorGainDecay:(null==e?void 0:e.modulatorGainDecay)||.3},this.modulator=new OscillatorNode(t,{frequency:this.lfoSettings.frequency,type:this.lfoSettings.type}),this.constantSource=new ConstantSourceNode(t,{offset:this.lfoSettings.center}),this.modulator.start(),this.constantSource.start(),this.modulatorGain=new GainNode(t,{gain:0}),this.modulator.connect(this.modulatorGain),this.gain=new GainNode(t),this.constantSource.connect(this.gain.gain),this.modulatorGain.connect(this.gain.gain)}}class C{close(){var t;null===(t=this.audioContext)||void 0===t||t.close()}ensureContext(){void 0===this.audioContext&&this.init()}init(){this.audioContext=new AudioContext,this.master=new GainNode(this.audioContext,{gain:.5*this.volume}),this.master.connect(this.audioContext.destination),this.nodes=Array(6).fill(0).map(()=>Array(6).fill(null)),this.nodes[0][0]=new S(this.audioContext,{note:"A0",synthGainCubeSettings:{gain:.5}}),this.nodes[0][1]=new _(this.audioContext,{amplitude:.5,center:.5}),this.nodes[0][0].connect(this.nodes[0][1].master),this.nodes[0][1].connect(this.master),this.nodes[1][0]=new S(this.audioContext,{note:"E1"}),this.nodes[1][1]=new _(this.audioContext,{amplitude:.5,center:.5}),this.nodes[1][0].connect(this.nodes[1][1].master),this.nodes[1][1].connect(this.master),this.nodes[2][0]=new S(this.audioContext,{note:"A1"}),this.nodes[2][1]=new _(this.audioContext,{amplitude:.5,center:.5}),this.nodes[2][0].connect(this.nodes[2][1].master),this.nodes[2][1].connect(this.master),this.nodes[3][0]=new S(this.audioContext,{note:"E2"}),this.nodes[3][1]=new _(this.audioContext,{amplitude:.5,center:.5,type:"sine"}),this.nodes[3][0].connect(this.nodes[3][1].master),this.nodes[3][1].connect(this.master),this.nodes[4][0]=new S(this.audioContext,{note:"A2"}),this.nodes[4][1]=new _(this.audioContext,{amplitude:.5,center:.5}),this.nodes[4][0].connect(this.nodes[4][1].master),this.nodes[4][1].connect(this.master),this.nodes[5][0]=new S(this.audioContext,{note:"E3"}),this.nodes[5][1]=new _(this.audioContext,{amplitude:.5,center:.5}),this.nodes[5][0].connect(this.nodes[5][1].master),this.nodes[5][1].connect(this.master)}pressCube(t){var e;let[n,o]=t;null===(e=this.nodes[n][o])||void 0===e||e.activate()}unpressCube(t){var e;let[n,o]=t;null===(e=this.nodes[n][o])||void 0===e||e.deactivate()}set volume(t){this._volume=t,this.master&&(this.master.gain.value=t)}get volume(){return this._volume}constructor(){this._volume=.5}}let E=(6*1.1-.1)*Math.SQRT2/2+1,N=E/4,L="u_view",T="u_ambientStrength",R="u_ambientColor",P="u_directionalLightStrength",F="u_directionalLightColor",G="u_directionalLightDirection",I="#version 300 es\nlayout(location = ".concat(0,") in vec4 a_position;\nlayout(location = ").concat(1,") in vec4 a_color;\nlayout(location = ").concat(2,") in vec4 a_normal;\nlayout(location = ").concat(3,") in float a_material;\n\nuniform mat4 ").concat(L,";\n\nout vec4 v_position;\nout vec4 v_color;\nout vec4 v_normal;\nout float v_material;\n\nvoid main() {\n	gl_Position = ").concat(L," * a_position;\n\n	v_position = a_position;\n	v_color = a_color;\n	v_normal = a_normal;\n	v_material = a_material;\n}\n"),O="#version 300 es\nprecision highp float;\n\nin vec4 v_position;\nin vec4 v_color;\nin vec4 v_normal;\nin float v_material;\n\nuniform float ".concat(T,";\nuniform vec3 ").concat(R,";\n\nuniform float ").concat(P,";\nuniform vec4 ").concat(G,";\nuniform vec3 ").concat(F,";\n\nout vec4 outColor;\n\nbool approx(float a, float b){\n	return abs(b - a) < 0.01f;\n}\n\nvoid main() {\n	if(approx(v_material, 1.0f)){\n		vec3 ambient = ").concat(T," * ").concat(R,";\n\n		float diffuseStrength = max(dot(-").concat(G,", normalize(v_normal)), 0.0) * ").concat(P,";\n\n		outColor = v_color * vec4(ambient + diffuseStrength * ").concat(F,", 1);\n	}\n	else{\n		outColor = v_color;\n	}\n}\n");function B(){let t=(0,s.Z)(),e=i.createRef(),n=i.createRef();return i.useEffect(()=>{if(e.current&&n.current)return function(t,e,n){var o;let i,a,r;let s=new C,f=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],v=!1,w=[-1,-1],y=[-1,-1],A=-1,S=-1;t.addEventListener("mousemove",t=>{f=[t.offsetX/y[0]*2-1,-(t.offsetY/y[1]*2-1)]});let _=t=>{for(let e of t){y=[e.contentBoxSize[0].inlineSize,e.contentBoxSize[0].blockSize];let t=e.devicePixelContentBoxSize?e.devicePixelContentBoxSize[0]:e.contentBoxSize[0],n=e.devicePixelContentBoxSize?1:window.devicePixelRatio,o=Math.round(t.inlineSize*n),i=Math.round(t.blockSize*n);(w[0]!=o||w[1]!=i)&&(v=!0),w=[o,i]}},B=new ResizeObserver(_);try{B.observe(e,{box:"device-pixel-content-box"})}catch(t){B.observe(e,{box:"content-box"})}let M=t.getContext("webgl2");M.enable(M.CULL_FACE),M.enable(M.DEPTH_TEST),M.cullFace(M.BACK);let V={primary:new l.Z(Z(n.palette.primary.main)),secondary:new l.Z(Z(n.palette.secondary.main))},j=c(M,M.VERTEX_SHADER,I),k=c(M,M.FRAGMENT_SHADER,O),z=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];let i=t.createProgram();for(let e of n)t.attachShader(i,e);t.linkProgram(i);let a=t.getProgramParameter(i,t.LINK_STATUS);if(!a){let e="Could not link program: ".concat(t.getProgramInfoLog(i));throw t.deleteProgram(i),e}return i}(M,j,k),D=t=>{let[e,n]=t,o=Math.ceil((-1+e)/1.1+3),i=Math.ceil((-1+n)/1.1+3);return!Number.isFinite(o)||!Number.isFinite(i)||o<0||o>=6||i<0||i>=6||(-1+e)/1.1+3>o||o>e/1.1+3||(-1+n)/1.1+3>i||i>n/1.1+3?null:[o,i]},U=new x({objects:{...Object.fromEntries(Array(6).fill(0).flatMap((t,e)=>Array(6).fill(0).map((t,n)=>["cube".concat(e).concat(n),new b({color:V.primary,transform:new g({origin:new h.Z(.5,.5,.5),translation:new h.Z((e-3)*1.1,-.49,(n-3)*1.1).add([.5,0,.5])}),material:1})]))),floor:new p({color:V.secondary,transform:new g({origin:new h.Z(.5,0,.5),translation:new h.Z(.5,0,.5).scale(-1),scale:new h.Z(100,100,100)}),material:0})}}),Y=M.createVertexArray();M.bindVertexArray(Y);let H=M.createBuffer();M.bindBuffer(M.ARRAY_BUFFER,H);let q=()=>{M.bufferData(M.ARRAY_BUFFER,U.vertices,M.DYNAMIC_DRAW)};q(),M.enableVertexAttribArray(0),M.enableVertexAttribArray(1),M.enableVertexAttribArray(2),M.enableVertexAttribArray(3);let K=0;M.vertexAttribPointer(0,4,M.FLOAT,!1,52,K),K+=16,M.vertexAttribPointer(1,4,M.FLOAT,!1,52,K),K+=16,M.vertexAttribPointer(2,4,M.FLOAT,!1,52,K),K+=16,M.vertexAttribPointer(3,1,M.FLOAT,!1,52,K),K+=4,M.useProgram(z);let W=M.getUniformLocation(z,L),X=M.getUniformLocation(z,T),Q=M.getUniformLocation(z,R),$=M.getUniformLocation(z,P),J=M.getUniformLocation(z,G),tt=M.getUniformLocation(z,F);M.uniform1f(X,.5),M.uniform3fv(Q,new h.Z(1,1,1)),M.uniform1f($,.5),M.uniform4fv(J,new u.Z().rotateY(5*Math.PI/6).rotateZ(-Math.PI/4).transformVector4([1,0,0,0])),M.uniform3fv(tt,new h.Z(1,1,1));let te=new d.Z,tn=new d.Z,to=new d.Z,ti=new d.Z,ta=new l.Z(new u.Z().rotateY(Math.PI/4).rotateZ(-Math.PI/4).transformVector4([1,0,0,0])).multiplyByScalar(-20),tr=()=>{v&&(t.style.width="".concat(y[0],"px"),t.style.height="".concat(y[1],"px"),t.width=w[0],t.height=w[1],v=!1,M.viewport(0,0,t.width,t.height),S=t.width/t.height,A=t.height/t.width,S>N?te.ortho({left:-4*S,right:4*S,bottom:-4,top:4,near:0,far:100}):te.ortho({left:-E,right:E,bottom:-E*A,top:E*A,near:0,far:100}),tn.lookAt({eye:ta,center:[0,0,0],up:[0,1,0]}),to.copy(tn).multiplyLeft(te),ti.copy(to).invert(),M.useProgram(z),M.uniformMatrix4fv(W,!1,to,0,to.ELEMENTS))};(o=i||(i={}))[o.None=0]="None",o[o.Hovered=1]="Hovered",o[o.Pressed=2]="Pressed";let ts=Array(6).fill(0).flatMap((t,e)=>Array(6).fill(0).map((t,n)=>[[e,n],i.None])),tc=t=>{let[e,n]=t;return ts[e][n]},tl=(t,e)=>{let[n,o]=t;ts[n][o]=e},th=new Set,tu=new Set,td=new Set,tm=!1;t.addEventListener("mouseup",t=>{tm=!0,s.ensureContext()});let tf=null,tg=null,tv=()=>{if(a=performance.now(),null!==tf&&(tg=a-tf),tr(),M.clearColor(0,0,0,0),M.clear(M.COLOR_BUFFER_BIT),M.drawArrays(M.TRIANGLES,0,U.points),tg){let t=new h.Z(ti.transform(new h.Z(...f,0))),e=t.y/ta.y;t.subtract(ta.clone().multiplyByScalar(e));let n=D([t.x,t.z]);if(null!==n){let t=tc(n);tu.has(n)||t==i.Pressed||tm||(tl(n,i.Hovered),th.add(n)),tu.forEach(t=>{(t[0]!==n[0]||t[1]!==n[1])&&(tl(t,i.None),th.add(t))}),tu.clear(),tm||t==i.Pressed?tm&&(t===i.Pressed?(td.delete(n),tl(n,i.None),s.unpressCube(n)):(td.add(n),tl(n,i.Pressed),s.pressCube(n)),th.add(n)):tu.add(n)}else tu.forEach(t=>{tl(t,i.None),th.add(t)});let o=th.size>0;for(let t of th){let[e,n]=t,o="cube".concat(e).concat(n),a=tc(t),r=a===i.None?-.49:a===i.Hovered?-.4:.5,s=U.objects[o].primitive.transform;1e-4>Math.abs(s.translation.y-r)?(s.translation.y=r,th.delete(t)):s.translation.y=(0,m.t7)(s.translation.y,r,tg/1e3*20),U.regenerateObject(o)}o&&q()}tm=!1,tf=a,r=requestAnimationFrame(tv)};r=requestAnimationFrame(tv);let tw=()=>{cancelAnimationFrame(r),M.deleteProgram(z),M.deleteShader(j),M.deleteShader(k),s.close()};return tw}(e.current,n.current,t)}),(0,o.jsxs)(r.Z,{position:"relative",width:"100%",height:"100%",overflow:"hidden",children:[(0,o.jsx)(a.Z,{}),(0,o.jsx)(r.Z,{ref:n,sx:{display:"flex",height:"100%",width:"100%"}}),(0,o.jsx)("canvas",{ref:e,style:{display:"block",position:"absolute",top:0,left:0}})]})}}},function(t){t.O(0,[26,774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);