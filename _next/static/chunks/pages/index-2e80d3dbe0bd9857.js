(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2011)}])},7361:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var o=n(5893),r=n(9008),i=n.n(r);function a(t){let{children:e}=t;return(0,o.jsx)(i(),{children:(0,o.jsx)("title",{children:e?"".concat(e," | Ketexon"):"Ketexon"})})}n(7294)},2011:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return F}});var o=n(5893),r=n(7294),i=n(7361),a=n(7357);function l(t,e,n){let o=t.createShader(e);t.shaderSource(o,n),t.compileShader(o);let r=t.getShaderParameter(o,t.COMPILE_STATUS);if(!r){let e="Could not compile shader: ".concat(t.getShaderInfoLog(o));throw t.deleteShader(o),e}return o}var c=n(1849),s=n(3855),f=n(8199),h=n(3176),m=n(4034);class u{}u.TRANSPARENT=c.Z.ZERO,u.BLACK=new c.Z(0,0,0,1),u.RED=new c.Z(1,0,0,1),u.YELLOW=new c.Z(1,1,0,1),u.GREEN=new c.Z(0,1,0,1),u.CYAN=new c.Z(0,1,1,1),u.BLUE=new c.Z(0,0,1,1),u.MAGENTA=new c.Z(1,0,1,1),u.WHITE=new c.Z(1,1,1,1);class d{transformPoint(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.subtract(this.origin).scale(this.scale).transformByQuaternion(this.rotation).add(e?s.Z.ZERO:this.origin).add(this.translation),t}constructor(t){if(this.origin=s.Z.ZERO,this.scale=new s.Z(1,1,1),this.rotation=new f.Z().identity(),this.translation=s.Z.ZERO,t){let{origin:e,scale:n,rotation:o,translation:r}=t;this.origin=e||this.origin,this.scale=n||this.scale,this.rotation=o||this.rotation,this.translation=r||this.translation}}}function w(t){let{bottomLeft:e,topLeft:n,bottomRight:o,topRight:r,flipFace:i,color:a}=t,l=t.material||0,f=new c.Z(...new s.Z().subVectors(o,e).cross(new s.Z().subVectors(n,e)).multiplyByScalar(i?-1:1),1);return!0!==i?[...n,1,...a,...f,l,...e,1,...a,...f,l,...o,1,...a,...f,l,...n,1,...a,...f,l,...o,1,...a,...f,l,...r,1,...a,...f,l]:[...e,1,...a,...f,l,...n,1,...a,...f,l,...o,1,...a,...f,l,...o,1,...a,...f,l,...n,1,...a,...f,l,...r,1,...a,...f,l]}d.IDENTITY=new d;class b{constructor(t){if(this.color=u.WHITE,this.transform=d.IDENTITY,this.material=0,t){let{color:e,transform:n,material:o}=t;this.color=e||this.color,this.transform=n||this.transform,this.material=o||this.material}}}class g extends b{generateVertices(){let t=t=>this.transform.transformPoint(t,!0);return[...w({bottomLeft:t(new s.Z(0,0,0)),topLeft:t(new s.Z(0,0,1)),bottomRight:t(new s.Z(1,0,0)),topRight:t(new s.Z(1,0,1)),color:this.color,flipFace:!0,material:this.material})]}}class p extends b{generateVertices(){let t=t=>this.transform.transformPoint(t,!0);return[...w({bottomLeft:t(new s.Z(0,0,0)),topLeft:t(new s.Z(0,1,0)),bottomRight:t(new s.Z(1,0,0)),topRight:t(new s.Z(1,1,0)),color:this.color,material:this.material,flipFace:!0}),...w({bottomLeft:t(new s.Z(0,0,0)),topLeft:t(new s.Z(0,0,1)),bottomRight:t(new s.Z(1,0,0)),topRight:t(new s.Z(1,0,1)),color:this.color,material:this.material,flipFace:!1}),...w({bottomLeft:t(new s.Z(0,0,0)),topLeft:t(new s.Z(0,0,1)),bottomRight:t(new s.Z(0,1,0)),topRight:t(new s.Z(0,1,1)),color:this.color,material:this.material,flipFace:!0}),...w({bottomLeft:t(new s.Z(0,0,1)),topLeft:t(new s.Z(0,1,1)),bottomRight:t(new s.Z(1,0,1)),topRight:t(new s.Z(1,1,1)),color:this.color,material:this.material,flipFace:!1}),...w({bottomLeft:t(new s.Z(0,1,0)),topLeft:t(new s.Z(0,1,1)),bottomRight:t(new s.Z(1,1,0)),topRight:t(new s.Z(1,1,1)),color:this.color,material:this.material,flipFace:!0}),...w({bottomLeft:t(new s.Z(1,0,0)),topLeft:t(new s.Z(1,0,1)),bottomRight:t(new s.Z(1,1,0)),topRight:t(new s.Z(1,1,1)),color:this.color,material:this.material,flipFace:!1})]}}class v{get bufferSize(){return 4*this.vertices.length}get points(){return this.bufferSize/52}regenerateObject(t){let e=this.objects[t].primitive.generateVertices();this.objects[t].subarray.set(e)}constructor({objects:t}){this.objects={};let e=Object.entries(t).map(t=>{let[e,n]=t;return[e,n instanceof Array?n.map(t=>t.generateVertices()):n.generateVertices()]}),n=e.reduce((t,e)=>{let[n,o]=e;return t+o.length},0);this.vertices=new Float32Array(n);let o=0;for(let[n,r]of e)this.vertices.set(r,o),this.objects[n]={primitive:t[n],subarray:this.vertices.subarray(o,o+r.length)},o+=r.length}}var Z=n(2734);function _(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return t.replace(/^#([a-f\d])([a-f\d])([a-f\d])([a-f\d])?$/i,(t,e,n,o,r)=>"#".concat(e).concat(e).concat(n).concat(n).concat(o).concat(o)+r?"".concat(r).concat(r):0).substring(1).padEnd(8,"f").match(/.{2}/g).map(t=>parseInt(t,16)*(e?1/255:1))}let A=(6*1.1-.1)*Math.SQRT2/2+1,y=A/4,E="u_view",x="u_ambientStrength",L="u_ambientColor",R="u_directionalLightStrength",S="u_directionalLightColor",P="u_directionalLightDirection",N="#version 300 es\nlayout(location = ".concat(0,") in vec4 a_position;\nlayout(location = ").concat(1,") in vec4 a_color;\nlayout(location = ").concat(2,") in vec4 a_normal;\nlayout(location = ").concat(3,") in float a_material;\n\nuniform mat4 ").concat(E,";\n\nout vec4 v_position;\nout vec4 v_color;\nout vec4 v_normal;\nout float v_material;\n\nvoid main() {\n	gl_Position = ").concat(E," * a_position;\n\n	v_position = a_position;\n	v_color = a_color;\n	v_normal = a_normal;\n	v_material = a_material;\n}\n"),T="#version 300 es\nprecision highp float;\n\nin vec4 v_position;\nin vec4 v_color;\nin vec4 v_normal;\nin float v_material;\n\nuniform float ".concat(x,";\nuniform vec3 ").concat(L,";\n\nuniform float ").concat(R,";\nuniform vec4 ").concat(P,";\nuniform vec3 ").concat(S,";\n\nout vec4 outColor;\n\nbool approx(float a, float b){\n	return abs(b - a) < 0.01f;\n}\n\nvoid main() {\n	if(approx(v_material, 1.0f)){\n		vec3 ambient = ").concat(x," * ").concat(L,";\n\n		float diffuseStrength = max(dot(-").concat(P,", normalize(v_normal)), 0.0) * ").concat(R,";\n\n		outColor = v_color * vec4(ambient + diffuseStrength * ").concat(S,", 1);\n	}\n	else{\n		outColor = v_color;\n	}\n}\n");function F(){let t=(0,Z.Z)(),e=r.createRef(),n=r.createRef();return r.useEffect(()=>{if(e.current&&n.current)return function(t,e,n){var o;let r,i,a,u=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],w=!1,b=[-1,-1],Z=[-1,-1],F=-1,I=-1;t.addEventListener("mousemove",t=>{u=[t.offsetX/Z[0]*2-1,-(t.offsetY/Z[1]*2-1)]});let C=t=>{for(let e of t){Z=[e.contentBoxSize[0].inlineSize,e.contentBoxSize[0].blockSize];let t=e.devicePixelContentBoxSize?e.devicePixelContentBoxSize[0]:e.contentBoxSize[0],n=e.devicePixelContentBoxSize?1:window.devicePixelRatio,o=Math.round(t.inlineSize*n),r=Math.round(t.blockSize*n);(b[0]!=o||b[1]!=r)&&(w=!0),b=[o,r]}},B=new ResizeObserver(C);try{B.observe(e,{box:"device-pixel-content-box"})}catch(t){B.observe(e,{box:"content-box"})}let O=t.getContext("webgl2");O.enable(O.CULL_FACE),O.enable(O.DEPTH_TEST),O.cullFace(O.BACK);let M={primary:new c.Z(_(n.palette.primary.main)),secondary:new c.Z(_(n.palette.secondary.main))},V=l(O,O.VERTEX_SHADER,N),j=l(O,O.FRAGMENT_SHADER,T),z=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];let r=t.createProgram();for(let e of n)t.attachShader(r,e);t.linkProgram(r);let i=t.getProgramParameter(r,t.LINK_STATUS);if(!i){let e="Could not link program: ".concat(t.getProgramInfoLog(r));throw t.deleteProgram(r),e}return r}(O,V,j),U=t=>{let[e,n]=t,o=Math.ceil((-1+e)/1.1+3),r=Math.ceil((-1+n)/1.1+3);return!Number.isFinite(o)||!Number.isFinite(r)||o<0||o>=6||r<0||r>=6||(-1+e)/1.1+3>o||o>e/1.1+3||(-1+n)/1.1+3>r||r>n/1.1+3?null:[o,r]},Y=new v({objects:{...Object.fromEntries(Array(6).fill(0).flatMap((t,e)=>Array(6).fill(0).map((t,n)=>["cube".concat(e).concat(n),new p({color:M.primary,transform:new d({origin:new s.Z(.5,.5,.5),translation:new s.Z((e-3)*1.1,-.49,(n-3)*1.1).add([.5,0,.5])}),material:1})]))),floor:new g({color:M.secondary,transform:new d({origin:new s.Z(.5,0,.5),translation:new s.Z(.5,0,.5).scale(-1),scale:new s.Z(100,100,100)}),material:0})}}),k=O.createVertexArray();O.bindVertexArray(k);let D=O.createBuffer();O.bindBuffer(O.ARRAY_BUFFER,D);let H=()=>{O.bufferData(O.ARRAY_BUFFER,Y.vertices,O.DYNAMIC_DRAW)};H(),O.enableVertexAttribArray(0),O.enableVertexAttribArray(1),O.enableVertexAttribArray(2),O.enableVertexAttribArray(3);let G=0;O.vertexAttribPointer(0,4,O.FLOAT,!1,52,G),G+=16,O.vertexAttribPointer(1,4,O.FLOAT,!1,52,G),G+=16,O.vertexAttribPointer(2,4,O.FLOAT,!1,52,G),G+=16,O.vertexAttribPointer(3,1,O.FLOAT,!1,52,G),G+=4,O.useProgram(z);let K=O.getUniformLocation(z,E),W=O.getUniformLocation(z,x),X=O.getUniformLocation(z,L),q=O.getUniformLocation(z,R),Q=O.getUniformLocation(z,P),$=O.getUniformLocation(z,S);O.uniform1f(W,.5),O.uniform3fv(X,new s.Z(1,1,1)),O.uniform1f(q,.5),O.uniform4fv(Q,new f.Z().rotateY(5*Math.PI/6).rotateZ(-Math.PI/4).transformVector4([1,0,0,0])),O.uniform3fv($,new s.Z(1,1,1));let J=new h.Z,tt=new h.Z,te=new h.Z,tn=new h.Z,to=new c.Z(new f.Z().rotateY(Math.PI/4).rotateZ(-Math.PI/4).transformVector4([1,0,0,0])).multiplyByScalar(-20);console.log(to);let tr=()=>{w&&(t.style.width="".concat(Z[0],"px"),t.style.height="".concat(Z[1],"px"),t.width=b[0],t.height=b[1],w=!1,O.viewport(0,0,t.width,t.height),I=t.width/t.height,F=t.height/t.width,I>y?J.ortho({left:-4*I,right:4*I,bottom:-4,top:4,near:0,far:100}):J.ortho({left:-A,right:A,bottom:-A*F,top:A*F,near:0,far:100}),tt.lookAt({eye:to,center:[0,0,0],up:[0,1,0]}),te.copy(tt).multiplyLeft(J),tn.copy(te).invert(),O.useProgram(z),O.uniformMatrix4fv(K,!1,te,0,te.ELEMENTS))};(o=r||(r={}))[o.None=0]="None",o[o.Hovered=1]="Hovered",o[o.Pressed=2]="Pressed";let ti=Array(6).fill(0).flatMap((t,e)=>Array(6).fill(0).map((t,n)=>[[e,n],r.None])),ta=t=>{let[e,n]=t;return ti[e][n]},tl=(t,e)=>{let[n,o]=t;ti[n][o]=e},tc=new Set,ts=new Set,tf=new Set,th=!1;t.addEventListener("click",t=>{th=!0});let tm=null,tu=null,td=()=>{if(i=performance.now(),null!==tm&&(tu=i-tm),tr(),O.clearColor(0,0,0,0),O.clear(O.COLOR_BUFFER_BIT),O.drawArrays(O.TRIANGLES,0,Y.points),tu){let t=new s.Z(tn.transform(new s.Z(...u,0))),e=t.y/to.y;t.subtract(to.clone().multiplyByScalar(e));let n=U([t.x,t.z]);if(null!==n){let t=ta(n);ts.has(n)||t==r.Pressed||th||(tl(n,r.Hovered),tc.add(n)),ts.forEach(t=>{(t[0]!==n[0]||t[1]!==n[1])&&(tl(t,r.None),tc.add(t))}),ts.clear(),th||t==r.Pressed?th&&(t===r.Pressed?(tf.delete(n),tl(n,r.None)):(tf.add(n),tl(n,r.Pressed)),tc.add(n)):ts.add(n)}else ts.forEach(t=>{tl(t,r.None),tc.add(t)});let o=tc.size>0;for(let t of tc){let[e,n]=t,o="cube".concat(e).concat(n),i=ta(t),a=i===r.None?-.49:i===r.Hovered?-.4:.5,l=Y.objects[o].primitive.transform;1e-4>Math.abs(l.translation.y-a)?(l.translation.y=a,tc.delete(t)):l.translation.y=(0,m.t7)(l.translation.y,a,tu/1e3*20),Y.regenerateObject(o)}o&&H()}th=!1,tm=i,a=requestAnimationFrame(td)};a=requestAnimationFrame(td);let tw=()=>{cancelAnimationFrame(a),O.deleteProgram(z),O.deleteShader(V),O.deleteShader(j)};return tw}(e.current,n.current,t)}),(0,o.jsxs)(a.Z,{position:"relative",width:"100%",height:"100%",overflow:"hidden",children:[(0,o.jsx)(i.Z,{}),(0,o.jsx)(a.Z,{ref:n,sx:{display:"flex",height:"100%",width:"100%"}}),(0,o.jsx)("canvas",{ref:e,style:{display:"block",position:"absolute",top:0,left:0}})]})}}},function(t){t.O(0,[26,774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);